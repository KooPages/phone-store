<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phone-Store</title>
<link rel="icon" type="image/x-icon" href="logo.jpg">
<style>
:root {
    --primary: #2c3e50;
    --secondary: #3498db;
    --accent: #27ae60;
    --danger: #e74c3c;
    --light: #f8f9fa;
    --dark: #2c3e50;
    --gray: #7f8c8d;
    --border: #ddd;
    --radius: 8px;
}
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f5f5f5;
    color: var(--dark);
    line-height: 1.5;
}
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 15px;
}
/* Banner */
.delivery-banner {
    background: #27ae60;
    color: white;
    padding: 12px;
    border-radius: var(--radius);
    margin-bottom: 20px;
    text-align: center;
    font-size: 0.95rem;
}
/* Header */
.header {
    background: white;
    border-radius: var(--radius);
    padding: 15px;
    margin-bottom: 20px;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    border: 1px solid var(--border);
}
.logo-section {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-wrap: wrap;
}
.logo {
    width: 50px;
    height: 50px;
    border-radius: 8px;
    object-fit: cover;
}
.title h1 {
    font-size: 1.5rem;
    color: var(--primary);
}
.title p {
    color: var(--gray);
    font-size: 0.9rem;
}
.cart-toggle {
    background: var(--secondary);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: var(--radius);
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
}
.cart-count {
    background: var(--danger);
    color: white;
    border-radius: 50%;
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
}
/* Grid de productos */
.products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
}
.product-card {
    background: white;
    border-radius: var(--radius);
    border: 1px solid var(--border);
}
.product-image-container {
    width: 100%;
    height: 180px;
    background: #f8f9fa;
    overflow: hidden;
    position: relative;
}
.product-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 10px;
}
.fullscreen-toggle {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(0,0,0,0.7);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 6px;
    cursor: pointer;
    font-size: 0.9rem;
}
.product-content {
    padding: 15px;
}
.product-id {
    background: var(--primary);
    color: white;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.8rem;
    margin-bottom: 8px;
    display: inline-block;
}
.product-title {
    font-size: 1.1rem;
    margin-bottom: 8px;
    color: var(--dark);
}
.product-description {
    color: var(--gray);
    margin-bottom: 12px;
    font-size: 0.9rem;
}
.product-price {
    color: var(--accent);
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 12px;
}
.product-controls {
    display: flex;
    gap: 8px;
}
.quantity-input {
    width: 70px;
    padding: 8px;
    border: 1px solid var(--border);
    border-radius: 4px;
    text-align: center;
}
.add-to-cart {
    flex: 1;
    background: var(--secondary);
    color: white;
    border: none;
    padding: 10px;
    border-radius: 4px;
    cursor: pointer;
}
/* Modal del carrito */
.cart-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 15px;
}
.cart-modal.active {
    display: flex;
}
.cart-modal-content {
    background: white;
    border-radius: var(--radius);
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
}
.cart-modal-header {
    padding: 15px;
    background: var(--primary);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.cart-modal-close {
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
}
.cart-modal-body {
    padding: 15px;
    flex: 1;
    overflow-y: auto;
}
.cart-items {
    max-height: 250px;
    overflow-y: auto;
    margin-bottom: 15px;
}
.cart-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}
.cart-item-remove {
    background: var(--danger);
    color: white;
    border: none;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    cursor: pointer;
}
/* Formulario */
.customer-form {
    margin: 15px 0;
    padding: 15px;
    background: #f8f9fa;
    border-radius: var(--radius);
}
.form-group {
    margin-bottom: 12px;
}
.form-group label {
    display: block;
    margin-bottom: 4px;
    font-weight: 600;
    font-size: 0.9rem;
}
.form-group input,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--border);
    border-radius: 4px;
    font-family: inherit;
}
.cart-total {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent);
    text-align: right;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid var(--border);
}
.cart-modal-footer {
    padding: 15px;
    border-top: 1px solid var(--border);
}
.whatsapp-button {
    width: 100%;
    background: #25D366;
    color: white;
    border: none;
    padding: 12px;
    border-radius: var(--radius);
    font-weight: 600;
    cursor: pointer;
}
.whatsapp-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
/* Modal de imagen */
.image-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9);
    z-index: 1100;
    align-items: center;
    justify-content: center;
    padding: 15px;
}
.image-modal.active {
    display: flex;
}
.image-modal-content img {
    max-width: 100%;
    max-height: 90vh;
    object-fit: contain;
}
.image-modal-close {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255,255,255,0.1);
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
}
/* Notificaciones */
.guide-notification {
    position: fixed;
    bottom: 15px;
    right: 15px;
    background: var(--primary);
    color: white;
    padding: 12px;
    border-radius: var(--radius);
    max-width: 300px;
    z-index: 1200;
    display: none;
}
.security-alert {
    position: fixed;
    top: 15px;
    right: 15px;
    background: var(--danger);
    color: white;
    padding: 12px;
    border-radius: var(--radius);
    z-index: 1200;
    display: none;
}
.empty-cart {
    text-align: center;
    color: var(--gray);
    padding: 30px 15px;
}
.loading {
    text-align: center;
    padding: 30px;
    color: var(--gray);
}
/* Responsive */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
    }
    .product-image-container {
        height: 160px;
    }
    .header {
        flex-direction: column;
        text-align: center;
    }
    .logo-section {
        justify-content: center;
    }
    .cart-modal-content {
        max-height: 85vh;
    }
}
@media (max-width: 480px) {
    .products-grid {
        grid-template-columns: 1fr;
    }
    .product-controls {
        flex-direction: column;
    }
    .quantity-input {
        width: 100%;
    }
}
</style>
</head>
<body>
<div class="delivery-banner">
    <h3>üöö Env√≠o Gratis a Domicilio</h3>
    <p>Env√≠o directo sin costos adicionales</p>
</div>

<div class="guide-notification" id="guideNotification">
    <h4 id="guideTitle">Gu√≠a</h4>
    <p id="guideMessage"></p>
    <button onclick="store.closeGuide()">Cerrar</button>
</div>

<div class="security-alert" id="securityAlert"></div>

<div class="image-modal" id="imageModal">
    <div class="image-modal-content">
        <img id="fullscreenImage" src="" alt="Imagen completa">
        <button class="image-modal-close" onclick="closeFullscreen()">‚úï</button>
    </div>
</div>

<div class="cart-modal" id="cartModal">
    <div class="cart-modal-content">
        <div class="cart-modal-header">
            <h2>üõí Carrito</h2>
            <button class="cart-modal-close" onclick="toggleCart()">‚úï</button>
        </div>
        <div class="cart-modal-body">
            <div class="cart-items" id="cartItems">
                <div class="empty-cart">Carrito vac√≠o</div>
            </div>
            
            <div class="customer-form" id="customerForm">
                <h3>üìù Datos de Env√≠o</h3>
                <div class="form-group">
                    <label for="customerName">Nombre *</label>
                    <input type="text" id="customerName" placeholder="Juan P√©rez">
                </div>
                <div class="form-group">
                    <label for="customerPhone">Tel√©fono *</label>
                    <input type="tel" id="customerPhone" placeholder="555-1234-567">
                </div>
                <div class="form-group">
                    <label for="customerAddress">Direcci√≥n *</label>
                    <textarea id="customerAddress" placeholder="Direcci√≥n completa"></textarea>
                </div>
            </div>
            
            <div class="cart-total" id="cartTotal">USD $0.00</div>
        </div>
        <div class="cart-modal-footer">
            <button class="whatsapp-button" id="whatsappButton" onclick="store.processOrder()" disabled>
                Completar datos para proceder
            </button>
        </div>
    </div>
</div>

<div class="container">
    <header class="header">
        <div class="logo-section">
            <img src="logo.jpg" alt="Logo" class="logo">
            <div class="title">
                <h1>Phone Store</h1>
                <p>Variedad de ofertas m√≥viles</p>
            </div>
        </div>
        <button class="cart-toggle" onclick="toggleCart()">
            üõí Carrito
            <span class="cart-count" id="cartCount">0</span>
        </button>
    </header>
    <main class="main-content">
        <section class="products-grid" id="productsGrid">
            <div class="loading">Cargando productos...</div>
        </section>
    </main>
</div>

<script>
class StoreManager {
    constructor() {
        this.products = [];
        this.cart = this.loadCart();
        this.customerData = this.loadCustomerData();
        this.init();
    }

    async init() {
        this.setupSecurity();
        await this.loadProducts();
        this.renderProducts();
        this.updateCartUI();
        this.bindEvents();
    }

    loadCart() {
        try {
            const saved = localStorage.getItem('phoneStoreCart');
            return saved ? JSON.parse(saved) : [];
        } catch {
            return [];
        }
    }

    loadCustomerData() {
        try {
            const saved = localStorage.getItem('phoneStoreCustomerData');
            return saved ? JSON.parse(saved) : { name: '', phone: '', address: '' };
        } catch {
            return { name: '', phone: '', address: '' };
        }
    }

    saveCart() {
        localStorage.setItem('phoneStoreCart', JSON.stringify(this.cart));
    }

    saveCustomerData() {
        localStorage.setItem('phoneStoreCustomerData', JSON.stringify(this.customerData));
    }

    async loadProducts() {
        this.products = [
            { id: 1, title: "Samsung Galaxy A26 8/256GB Black", description: "Producto sellado con accesorios", price: 245, image: "1.jpg" },
            { id: 2, title: "Samsung Galaxy A17 4/128GB Black", description: "Producto sellado con accesorios", price: 200, image: "2.jpg" },
            { id: 3, title: "Samsung A16 5M/DS 4/128GB LTE", description: "Producto sellado con accesorios", price: 165, image: "3.jpg" },
            { id: 4, title: "Itel City 100 4/128GB", description: "Producto sellado con accesorios", price: 125, image: "4.jpg" },
            { id: 5, title: "Redmi Note 14 6/128GB Black", description: "Producto sellado con accesorios", price: 200, image: "5.jpg" },
            { id: 6, title: "Samsung A26 6/128GB 5G Black", description: "Producto sellado con accesorios", price: 230, image: "6.jpg" },
            { id: 7, title: "Itel A50C 2/64GB Blue", description: "Producto sellado con accesorios", price: 105, image: "7.jpg" },
            { id: 8, title: "Samsung Galaxy A17 6/128GB Black", description: "Producto sellado con accesorios", price: 210, image: "8.jpg" },
            { id: 9, title: "Samsung Galaxy A17 8/256GB Black", description: "Producto sellado con accesorios", price: 245, image: "9.jpg" },
            { id: 10, title: "Samsung Galaxy A36 8/256GB", description: "Producto sellado con accesorios", price: 305, image: "10.jpg" },
            { id: 11, title: "Samsung Galaxy A56 8/256GB Awesome Lihtgray", description: "Producto sellado con accesorios", price: 340, image: "11.jpg" },
            { id: 12, title: "Xiaomi Redmi Note 15 8/256GB", description: "Producto sellado con accesorios", price: 250, image: "12.jpg" },
        ];
    }

    renderProducts() {
        const grid = document.getElementById('productsGrid');
        grid.innerHTML = this.products.map(product => `
            <div class="product-card" data-id="${product.id}">
                <div class="product-image-container">
                    <img src="${product.image}" alt="${product.title}" class="product-image">
                    <button class="fullscreen-toggle" onclick="store.openFullscreen('${product.image}')">
                        üîç
                    </button>
                </div>
                <div class="product-content">
                    <span class="product-id">ID: ${String(product.id).padStart(3, '0')}</span>
                    <h3 class="product-title">${product.title}</h3>
                    <p class="product-description">${product.description}</p>
                    <div class="product-price">USD $${product.price}</div>
                    <div class="product-controls">
                        <input type="number" class="quantity-input" min="1" max="99" value="1">
                        <button class="add-to-cart" onclick="store.addToCart(${product.id})">A√±adir al Carrito</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    addToCart(productId) {
        const product = this.products.find(p => p.id === productId);
        if (!product) return;

        const quantityInput = document.querySelector(`.product-card[data-id="${productId}"] .quantity-input`);
        const quantity = Math.min(99, Math.max(1, parseInt(quantityInput.value) || 1));

        const existingItem = this.cart.find(item => item.id === productId);
        if (existingItem) {
            existingItem.quantity = Math.min(99, existingItem.quantity + quantity);
        } else {
            this.cart.push({
                id: product.id,
                title: product.title,
                price: product.price,
                quantity: quantity,
                image: product.image
            });
        }

        quantityInput.value = 1;
        this.saveCart();
        this.updateCartUI();
        this.showNotification('‚úÖ Producto a√±adido');
    }

    removeFromCart(index) {
        this.cart.splice(index, 1);
        this.saveCart();
        this.updateCartUI();
    }

    updateCartUI() {
        const cartCount = document.getElementById('cartCount');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const customerForm = document.getElementById('customerForm');
        const whatsappButton = document.getElementById('whatsappButton');

        cartCount.textContent = this.cart.reduce((sum, item) => sum + item.quantity, 0);

        if (this.cart.length === 0) {
            cartItems.innerHTML = '<div class="empty-cart">Carrito vac√≠o</div>';
            cartTotal.textContent = 'USD $0.00';
            customerForm.style.display = 'none';
            whatsappButton.disabled = true;
            whatsappButton.textContent = 'Completar datos para proceder';
            return;
        }

        cartItems.innerHTML = this.cart.map((item, index) => `
            <div class="cart-item">
                <div class="cart-item-info">
                    <div class="cart-item-title">${item.title}</div>
                    <div class="cart-item-details">
                        ${item.quantity} √ó USD $${item.price.toFixed(2)}
                    </div>
                </div>
                <button class="cart-item-remove" onclick="store.removeFromCart(${index})">‚úï</button>
            </div>
        `).join('');

        customerForm.style.display = 'block';
        const total = this.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        cartTotal.textContent = `USD $${total.toFixed(2)}`;

        this.updateCustomerForm();
        this.validateForm();
    }

    updateCustomerForm() {
        document.getElementById('customerName').value = this.customerData.name;
        document.getElementById('customerPhone').value = this.customerData.phone;
        document.getElementById('customerAddress').value = this.customerData.address;
        
        const inputs = document.querySelectorAll('#customerForm input, #customerForm textarea');
        inputs.forEach(input => {
            input.addEventListener('input', () => {
                this.customerData[input.id.replace('customer', '').toLowerCase()] = input.value;
                this.saveCustomerData();
                this.validateForm();
            });
        });
    }

    validateForm() {
        const name = document.getElementById('customerName').value.trim();
        const phone = document.getElementById('customerPhone').value.trim();
        const address = document.getElementById('customerAddress').value.trim();
        const whatsappButton = document.getElementById('whatsappButton');

        const isValid = name.length > 3 && phone.length >= 8 && address.length > 10;
        
        if (isValid) {
            whatsappButton.disabled = false;
            whatsappButton.textContent = 'Comprar por WhatsApp';
        } else {
            whatsappButton.disabled = true;
            whatsappButton.textContent = 'Completar datos para proceder';
        }
        
        return isValid;
    }

    setupSecurity() {
        document.addEventListener('contextmenu', (e) => {
            if (e.target.tagName === 'IMG') {
                e.preventDefault();
                this.showNotification('Acci√≥n bloqueada');
            }
        });
    }

    showNotification(message) {
        const alert = document.getElementById('securityAlert');
        alert.textContent = message;
        alert.style.display = 'block';
        setTimeout(() => alert.style.display = 'none', 1500);
    }

    bindEvents() {
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.cart-modal-content') && !e.target.closest('.cart-toggle')) {
                document.getElementById('cartModal').classList.remove('active');
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('cartModal').classList.remove('active');
                document.getElementById('imageModal').classList.remove('active');
            }
        });
    }

    openFullscreen(imageUrl) {
        document.getElementById('fullscreenImage').src = imageUrl;
        document.getElementById('imageModal').classList.add('active');
    }

    closeFullscreen() {
        document.getElementById('imageModal').classList.remove('active');
    }

    processOrder() {
        if (this.cart.length === 0 || !this.validateForm()) return;

        const phoneNumber = '+5355795822';
        const orderData = this.formatOrderData();
        const message = this.generateWhatsAppMessage(orderData);
        
        window.open(`https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`, '_blank');
        this.clearCart();
    }

    formatOrderData() {
        const total = this.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        return {
            date: new Date().toLocaleDateString('es-ES'),
            time: new Date().toLocaleTimeString('es-ES'),
            customer: this.customerData,
            items: this.cart.map(item => ({
                id: item.id,
                title: item.title,
                price: item.price,
                quantity: item.quantity,
                subtotal: item.price * item.quantity
            })),
            total: total,
            itemCount: this.cart.reduce((sum, item) => sum + item.quantity, 0)
        };
    }

    generateWhatsAppMessage(orderData) {
        let message = `*üì± PEDIDO PHONE STORE*\n`;
        message += `üìÖ Fecha: ${orderData.date}\n`;
        message += `‚è∞ Hora: ${orderData.time}\n\n`;
        
        message += `*üë§ DATOS:*\n`;
        message += `Nombre: ${orderData.customer.name}\n`;
        message += `Tel√©fono: ${orderData.customer.phone}\n`;
        message += `Direcci√≥n: ${orderData.customer.address}\n\n`;
        
        message += `*üõí PRODUCTOS (${orderData.itemCount}):*\n`;
        orderData.items.forEach((item, index) => {
            message += `${index + 1}. ${item.title}\n`;
            message += `   Cantidad: ${item.quantity}\n`;
            message += `   Subtotal: USD $${item.subtotal.toFixed(2)}\n\n`;
        });

        message += `üí∞ *TOTAL: USD $${orderData.total.toFixed(2)}*\n`;
        message += `üöö *ENV√çO GRATIS INCLUIDO*\n`;
        return message;
    }

    clearCart() {
        this.cart = [];
        this.saveCart();
        this.updateCartUI();
        this.showNotification('‚úÖ Pedido enviado');
        document.getElementById('cartModal').classList.remove('active');
    }
}

function toggleCart() {
    document.getElementById('cartModal').classList.toggle('active');
}

function closeFullscreen() {
    store.closeFullscreen();
}

window.store = new StoreManager();
</script>
</body>
</html>